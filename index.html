<!DOCTYPE html>
<html lang="en">
<!--
Company:  IE Digital - Pacman Game
Name:     Viswanadh Bhaskarla
-->
  <head>
    <title>pacman</title>
    <script type="text/javascript" src="jquery-2.1.3.min.js"></script>
    <meta name='viewport' content = 'width = device-width, initial-scale = 1.0, user-scalable = no'/>

    <script type="text/javascript">
      // Loading game board, pacman and enemies
      $(document).ready(function(){
        for (var i=0; i < 5; i++){
          $("body").append("<br>");
          for(var j=0; j < 5; j++){
            $("body").append("<div class='block' style='top: " + 300 + "px;'></div>");
          }
        }
      });

      // Getting the user input and formatting it.
      function getInput(){

        var gameInput = document.getElementById('input').value;
        var pacman = document.getElementById('pacman');
        console.log(gameInput);

        if(gameInput.startsWith("PLACE")){
          var fields = gameInput.split(' ');
          console.log(fields.length);

          var placeCommand = fields[1].split(',');

          //Commands when x is 0
          if((placeCommand[0] == 0) && (placeCommand[2] == "NORTH")){
            pacman.style.left = 15 + 'px';
            pacman.style.top = (520 - ((placeCommand[1])*82)) + 'px';
            pacman.style.transform = 'rotate(90deg)';
          }
          if((placeCommand[0] == 0) && (placeCommand[2] == "EAST")){
            pacman.style.left = 15 + 'px';
            pacman.style.top = (520 - ((placeCommand[1])*82)) + 'px';
            pacman.style.transform = 'rotate(180deg)';
          }
          if((placeCommand[0] == 0) && (placeCommand[2] == "SOUTH")){
            pacman.style.left = 15 + 'px';
            pacman.style.top = (520 - ((placeCommand[1])*82)) + 'px';
            pacman.style.transform = 'rotate(270deg)';
          }
          if((placeCommand[0] == 0) && (placeCommand[2] == "WEST")){
            pacman.style.left = 15 + 'px';
            pacman.style.top = (520 - ((placeCommand[1])*82)) + 'px';
            pacman.style.transform = 'rotate(360deg)';
          }

          //Commands when x is 1
          if((placeCommand[0] == 1) && (placeCommand[2] == "NORTH")){
            pacman.style.left = 95 + 'px';
            pacman.style.top = (520 - ((placeCommand[1])*82)) + 'px';
            pacman.style.transform = 'rotate(90deg)';
          }
          if((placeCommand[0] == 1) && (placeCommand[2] == "EAST")){
            pacman.style.left = 95 + 'px';
            pacman.style.top = (520 - ((placeCommand[1])*82)) + 'px';
            pacman.style.transform = 'rotate(180deg)';
          }
          if((placeCommand[0] == 1) && (placeCommand[2] == "SOUTH")){
            pacman.style.left = 95 + 'px';
            pacman.style.top = (520 - ((placeCommand[1])*82)) + 'px';
            pacman.style.transform = 'rotate(270deg)';
          }
          if((placeCommand[0] == 1) && (placeCommand[2] == "WEST")){
            pacman.style.left = 95 + 'px';
            pacman.style.top = (520 - ((placeCommand[1])*82)) + 'px';
            pacman.style.transform = 'rotate(360deg)';
          }

          //Commands when x is 2
          if((placeCommand[0] == 2) && (placeCommand[2] == "NORTH")){
            pacman.style.left = 175 + 'px';
            pacman.style.top = (520 - ((placeCommand[1])*82)) + 'px';
            pacman.style.transform = 'rotate(90deg)';
          }
          if((placeCommand[0] == 2) && (placeCommand[2] == "EAST")){
            pacman.style.left = 175 + 'px';
            pacman.style.top = (520 - ((placeCommand[1])*82)) + 'px';
            pacman.style.transform = 'rotate(180deg)';
          }
          if((placeCommand[0] == 2) && (placeCommand[2] == "SOUTH")){
            pacman.style.left = 175 + 'px';
            pacman.style.top = (520 - ((placeCommand[1])*82)) + 'px';
            pacman.style.transform = 'rotate(270deg)';
          }
          if((placeCommand[0] == 2) && (placeCommand[2] == "WEST")){
            pacman.style.left = 175 + 'px';
            pacman.style.top = (520 - ((placeCommand[1])*82)) + 'px';
            pacman.style.transform = 'rotate(360deg)';
          }

          //Commands when x is 3
          if((placeCommand[0] == 3) && (placeCommand[2] == "NORTH")){
            pacman.style.left = 255 + 'px';
            pacman.style.top = (520 - ((placeCommand[1])*82)) + 'px';
            pacman.style.transform = 'rotate(90deg)';
          }
          if((placeCommand[0] == 3) && (placeCommand[2] == "EAST")){
            pacman.style.left = 255 + 'px';
            pacman.style.top = (520 - ((placeCommand[1])*82)) + 'px';
            pacman.style.transform = 'rotate(180deg)';
          }
          if((placeCommand[0] == 3) && (placeCommand[2] == "SOUTH")){
            pacman.style.left = 255 + 'px';
            pacman.style.top = (520 - ((placeCommand[1])*82)) + 'px';
            pacman.style.transform = 'rotate(270deg)';
          }
          if((placeCommand[0] == 3) && (placeCommand[2] == "WEST")){
            pacman.style.left = 255 + 'px';
            pacman.style.top = (520 - ((placeCommand[1])*82)) + 'px';
            pacman.style.transform = 'rotate(360deg)';
          }

          //Commands when x is 4
          if((placeCommand[0] == 4) && (placeCommand[2] == "NORTH")){
            pacman.style.left = 335 + 'px';
            pacman.style.top = (520 - ((placeCommand[1])*82)) + 'px';
            pacman.style.transform = 'rotate(90deg)';
          }
          if((placeCommand[0] == 4) && (placeCommand[2] == "EAST")){
            pacman.style.left = 335 + 'px';
            pacman.style.top = (520 - ((placeCommand[1])*82)) + 'px';
            pacman.style.transform = 'rotate(180deg)';
          }if((placeCommand[0] == 4) && (placeCommand[2] == "SOUTH")){
            pacman.style.left = 335 + 'px';
            pacman.style.top = (520 - ((placeCommand[1])*82)) + 'px';
            pacman.style.transform = 'rotate(270deg)';
          }if((placeCommand[0] == 4) && (placeCommand[2] == "WEST")){
            pacman.style.left = 335 + 'px';
            pacman.style.top = (520 - ((placeCommand[1])*82)) + 'px';
            pacman.style.transform = 'rotate(360deg)';
          }

          //Function to get x and y coordinates
          function findTopLeft(pacman) {
            var rec = pacman.getBoundingClientRect();
            return {top: rec.top + window.scrollY, left: rec.left + window.scrollX};
          }

          // Conditions to implement left,right,move and report commands.
          for(var i = 2; i < fields.length; i++){
            console.log("loop entered");

            if(fields[i] == "LEFT"){
              console.log("left action");
              pacman.style.transform = 'rotate(270deg)';
            }

            if(fields[i] == "RIGHT"){
              console.log("right action");
              pacman.style.transform = 'rotate(90deg)';
            }

            if(fields[i] == "MOVE"){
              console.log("move action");
              if(placeCommand[2] == "NORTH"){
                pacman.style.top = findTopLeft(pacman).top - 82 + 'px';
              }
              if(placeCommand[2] == "EAST"){
                pacman.style.left = findTopLeft(pacman).left + 80 + 'px';
              }
              if(placeCommand[2] == "SOUTH"){
                pacman.style.top = findTopLeft(pacman).top + 82 + 'px';
              }
              if(placeCommand[2] == "WEST"){
                pacman.style.left = findTopLeft(pacman).left - 80 + 'px';
              }
            }

            if(fields[i] == "REPORT"){
              $("body").append("<h3>" + findTopLeft(pacman).top, findTopLeft(pacman).left + "</h3>");
            }
          }

        }
        //Else condition to alert user to enter valid place command
        else{
          alert('Please enter a valid place command');
        }
      }

    </script>

    <style type="text/css">
      .block {
        width: 80px;
        height: 80px;
        background-image: url('Images/block.png');
        display: inline-block;
      }

      .pacman{
        width: 65px;
        height: 65px;
        left: 15px;
        top: 520px;
        background-image: url('Images/pacman.png');
        position: absolute;
      }

    </style>
  </head>

  <body>
    <div id ="pacman" class="pacman"></div>
    
    <h3>User Input</h3>
    <form>
      Game inputs: <input type="text" id="input"><br>
      <input type="button" value="Submit" onclick="getInput();">
    </form>

    <h3>Pacman Location:</h3>

  </body>

</html>
